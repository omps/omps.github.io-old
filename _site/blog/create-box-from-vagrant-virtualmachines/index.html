<!DOCTYPE html><html lang="en" itemscope itemtype="http://schema.org/WebPage"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Create box from vagrant virtualmachines | omps.in</title><meta name=description content="Vagrant Boxes are prepackaged development environments that are the foundation of Vagrant. In most cases, this is usually just a stripped and naked operating..."><meta name=viewport content="width=device-width, initial-scale=1"><meta http-equiv="cache-control" content="public"/><meta http-equiv="pragma" content="public"><meta name="keywords" content="omps.in, blog, Theme, Jekyll" /><meta name="author" content="omps" /><meta property="og:locale" content="en" /><meta property="og:site_name" content="omps.in" /><meta property="og:type" content="Website" /><meta property="og:url" content="http://localhost:4000/blog/create-box-from-vagrant-virtualmachines/" /><meta property="og:description" content="Welcome to omps.in" /><meta property="og:title" content="Create box from vagrant virtualmachines - omps.in" /><link rel="canonical" href="http://localhost:4000/blog/create-box-from-vagrant-virtualmachines/"><link rel="alternate" type="application/rss+xml" title="omps.in" href="http://localhost:4000/feed.xml"> <script type="application/ld+json"> {"@context": "http://schema.org", "@type": "Website", "name": "omps", "headline": "omps.in", "author": {"@type": "Person", "name": {"omps.in"}}, "description": "Welcome to omps.in", "url": "http://localhost:4000"} </script> <script type="text/javascript"> var GLOBAL_BASEURL = "http://localhost:4000"; </script><link rel="icon" type="image/png" sizes="32x32" href="http://localhost:4000/assets/images/favicon/favicon-32x32.png"><link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"><link href="https://fonts.googleapis.com/css?family=Space+Mono" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,600i,700,700i,800,800i" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Gloria+Hallelujah" rel="stylesheet"><link rel="stylesheet" href="http://localhost:4000/assets/stylesheets/main.css"> <script> var url_site = "http://localhost:4000", url_production = "http://localhost:4000"; if (url_site != url_production) { (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-90440415-1', 'auto'); ga('set', 'forceSSL', true); ga('send', 'pageview'); }; </script></head><body><div class="main" id="top"><div class="container wrapper"><div class="row"><div class="col-sm-3 sidebar"><div class="row header"><h2><a href="http://localhost:4000"><br>omps.in! </a></h2></div><div class="row menu"><ul><li class="nav-item"> <i class="fa fa-home" aria-hidden="true"></i>&nbsp;<a href="http://localhost:4000/">Home</a></li><hr class="breakline"><li class="nav-item"> <i class="fa fa-edit" aria-hidden="true"></i>&nbsp;<a href="http://localhost:4000/blog/" >Blog</a></li><li class="nav-item"> <i class="fa fa-search" aria-hidden="true"></i>&nbsp;<a href="http://localhost:4000/blog/search/" >Search</a></li><li class="nav-item"> <i class="fa fa-tags" aria-hidden="true"></i>&nbsp;<a href="http://localhost:4000/blog/tags/" >Tags</a></li><li class="nav-item"> <i class="fa fa-briefcase" aria-hidden="true"></i>&nbsp;<a href="http://localhost:4000/projects/" onclick="ga('send', 'event', 'linkTo', 'http://localhost:4000/projects/', 'Projects');" >Projects</a></li><li class="nav-item"> <i class="fa fa-file-text-o" aria-hidden="true"></i>&nbsp;<a href="http://localhost:4000/resume/" onclick="ga('send', 'event', 'linkTo', 'http://localhost:4000/resume/', 'Resume');" >Resume</a></li><li class="nav-item"> <i class="fa fa-rss" aria-hidden="true"></i>&nbsp;<a href="http://localhost:4000/feed.xml" >Feed</a></li><li class="nav-item"> <i class="fa fa-envelope" aria-hidden="true"></i>&nbsp;<a href="http://localhost:4000/contact/" >Contact</a></li></ul><div class="socials"><div class="row"><p></p><p>Follow Me!</p><div id="github" class="col-sm-3 columns"> <a href="https://github.com/omps/" target="_blank" title="GitHub" onclick="ga('send', 'event', 'linkTo', 'GitHub', 'Social Network', {useBeacon: true});" > <i class="fa fa-github icon" aria-hidden="true"></i> </a></div><div id="twitter" class="col-sm-3 columns"> <a href="https://twitter.com/ohgnis" target="_blank" title="Twitter" onclick="ga('send', 'event', 'linkTo', 'Twitter', 'Social Network', {useBeacon: true});" > <i class="fa fa-twitter icon" aria-hidden="true"></i> </a></div><div id="gplus" class="col-sm-3 columns"> <a href="https://plus.google.com/u/1/+OmPrakashomps" target="_blank" title="Google Plus" onclick="ga('send', 'event', 'linkTo', 'Google Plus', 'Social Network', {useBeacon: true});" > <i class="fa fa-google-plus icon" aria-hidden="true"></i> </a></div><div id="linkedin" class="col-sm-3 columns"> <a href="https://www.linkedin.com/in/ompsingh/" target="_blank" title="LinkedIn" onclick="ga('send', 'event', 'linkTo', 'LinkedIn', 'Social Network', {useBeacon: true});" > <i class="fa fa-linkedin icon" aria-hidden="true"></i> </a></div></div></div></div></div><div class="col-sm-9 content-main"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><div class="row title"><h1>Create box from vagrant virtualmachines</h1></div><div class="row meta" datetime="2016-04-25"> <time class="col-sm-6 datetime"> <i class="fa fa-calendar" aria-hidden="true"></i><span class="text tmargin "> 25 Abril, 2016 </span> </time><div class="col-sm-6 count-comments"> <span class="wrap"><i class="fa fa-comments" aria-hidden="true"></i>&nbsp;<a href="#comments" data-disqus-identifier="/blog/create-box-from-vagrant-virtualmachines/">0</a></span></div></div><div class="row tag-list"> <i class="fa fa-tags" aria-hidden="true"></i> <a href="http://localhost:4000/blog/tags//howto,">howto,</a> <a href="http://localhost:4000/blog/tags//vagrant,">vagrant,</a> <a href="http://localhost:4000/blog/tags//puppet">puppet</a></div><div class="row"> Read this in "about 5 minutes".</div><div class="row content"><p>Vagrant Boxes are prepackaged development environments that are the foundation of Vagrant. In most cases, this is usually just a stripped and naked operating system such as Ubuntu, Debian, or CentOS. Boxes exist with the intention to be provisioned with additional features like Apache and PHP using tools like Chef or Puppet. This is really powerful, but it can be time consuming to setup the first configuration and difficult for beginners. Plus, not everyone has the skill-set of a system admin or work with a huge collaborative team. This post will describe to you how to create your own prepackaged Vagrant Box from and existing virtual machine. In my opinion, it’s the quickest and easiest way for beginners to get started with Vagrant. This way you’ll be able to reuse it over and over and even share it. I feel this generally goes against the main idea of Vagrant where you provision your development environments from a single config. You generally lose a lot of the debugging and configurability of your development environment, but this should be helpful for plenty of developers, teams, and projects regardless.</p><ul><li>The first thing you’ll need to do is pick a box that you want to build from. The Vagrant Cloud lets you easily find boxes that people have shared. We’ll be working off of Hashicorp’s (Vagrant’s) Precise64. This box is a good one to work off of because Chef and Puppet are already installed, plus all the settings we’re configured by the creator(s) of Vagrant.</li></ul><p>![alt text](https://cask.scotch.io/2014/10/popularvagrant.jpg “”)</p><ul><li><p>After you’ve chosen a box, initialize the Vagrant box. Each one is slightly different, but here’s how to do it for the example we’re doing:</p><p>vagrant init hashicorp/precise64</p></li></ul><p>This will also create a Vagrant file for you. Now, boot the box with Vagrant by doing (it will need to download if it’s the first time using the it):</p><pre><code> vagrant up
</code></pre><ul><li><p>We’ll now SSH into the box and start customizing it. If you don’t know anything about servers, you can always just use Scotch Box since all of this is already done for you. Here’s how to SSH into the box:</p><p>vagrant ssh</p></li></ul><p>Now, we need to setup our server by installing whatever we want on it. This example will install a basic LAMP stack, but you can do whatever you like (Ruby, Nginx, etc.). The point of this article isn’t to teach you how to setup a server, but instead how to turn your virtual environment into a Vagrant Box. So this step might be more involved than what is actually shown:</p><pre><code class="language-sh">sudo apt-get update
sudo apt-get upgrade
sudo apt-get install vim
sudo apt-get install apache2
sudo apt-get install mysql-server libapache2-mod-auth-mysql php5-mysql
sudo mysql_install_db
sudo /usr/bin/mysql_secure_installation
sudo apt-get install php5 libapache2-mod-php5 php5-mcrypt
sudo apt-get install php5-cgi php5-cli php5-curl php5-common php5-gd php5-mysql
sudo service apache2 restart
</code></pre><ul><li><p>We’re now going to clean up disk space on the VM so when we package it into a new Vagrant box, it’s as clean as possible. First, remove APT cache</p><p>sudo apt-get clean</p></li></ul><p>Then, “zero out” the drive (this is for Ubuntu):</p><pre><code class="language-sh">sudo dd if=/dev/zero of=/EMPTY bs=1M
sudo rm -f /EMPTY
</code></pre><p>Lastly, let’s clear the Bash History and exit the VM:</p><pre><code> cat /dev/null &gt; ~/.bash_history &amp;&amp; history -c &amp;&amp; exit
</code></pre><ul><li><p>We’re now going to repackage the server we just created into a new Vagrant Base Box. It’s very easy with Vagrant:</p><p>vagrant package –output mynew.box</p></li><li><p>The previous command will have created a “mynew.box” file. You can technically put this wherever you want on your computer. Now, let’s add this new Vagrant Box into Vagrant:</p><p>vagrant box add mynewbox mynew.box</p></li></ul><p>This now will “download” the box into your Vagrant install allowing to initiate this from any folder, but before we do this, let’s delete and remove the Vagrant file we built this box from.</p><pre><code>vagrant destroy
rm Vagrantfile
</code></pre><ul><li><p>We need to now initialize a Vagrant environment from our brand new box using the same command from earlier but referencing the new Box.</p><p>vagrant init mynewbox</p></li><li><p>When you initialize the Vagrant environment, it creates a Vagrantfile for you (just like from before). Open the Vagrantfile and delete everything. You can use what was in there as a reference or just use Vagrant’s Official Docs, but we’re going to only use the absolute essentials that I’ve already spelled out for you.</p></li></ul><p>Now paste the following bare-bones code into your Vagrantfile:</p><p>Now let’s create a landing page:</p><pre><code> cat index.php
 phpinfo();
</code></pre><ul><li>Now, visit the IP address from the Vagrantfile in your browser. If everything works, you should see a PHP info dump of the index.php file you just created.</li></ul><p>![alt text](https://cask.scotch.io/2014/10/vagrantsuccess.jpg “”)</p><ul><li>Now that you’ve just created your own Vagrant Base Box from an existing one, you should consider sharing it on the Vagrant Cloud. This way other people can download and use it!</li></ul><p>There are tons of way of building Vagrant Boxes, and this method is only intended to get you started in the easiest and fastest way. You should consider these additional resources if you want to build from scratch or use a service to help you with the process:</p><p>Packer.io – A tool for creating identical machine images for multiple platforms from a single source configuration. PuPHPet – A simple GUI to set up virtual machines for Web development. Building a Vagrant Box from Start to Finish Creating a Custom Vagrant Box from Scratch Vagrant: Up and Running Shell Provisioner Chef Solo Provisioner Puppet Apply Provisioner</p><p>Alternative, if you want to just focus on the code and still use Vagrant, you can use my Vagrant Base Box, Scotch Box.</p><p><em>Note</em>: text verbatim from https://scotch.io/tutorials/how-to-create-a-vagrant-base-box-from-an-existing-one.</p><div class="row sharebutton"><ul class="wrapper"><li class="title">Share</li><li class="fb"> <a href="#" title="Share on Facebook" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),'facebook-share-dialog','width=626,height=436');return false;">Facebook</a></li><li class="linkedin"> <a href="http://www.linkedin.com/cws/share?url=http://localhost:4000/blog/create-box-from-vagrant-virtualmachines/" onclick="window.open(this.href,&quot;popupwindow&quot;,&quot;status=0,height=500,width=700,resizable=0,top=50,left=100&quot;);return false;" target="_blank" title="Share on LinkedIn">Linkedin</a></li><li class="googleplus"> <a href="https://plus.google.com/share?url=http://localhost:4000/blog/create-box-from-vagrant-virtualmachines/" onclick="window.open(this.href,&quot;popupwindow&quot;,&quot;status=0,height=500,width=700,resizable=0,top=50,left=100&quot;);return false;" target="_blank" title="Share on Google Plus">Google+</a></li></ul></div><div class="day-quote"><div class="title"></div><div class="content"></div></div><div class="row author"><div class="col-sm-2 image"> <img class="img-responsive center-block" src="http://localhost:4000/assets/images/author/typing.svg" alt=""></div><div class="col-sm-10 bio"><p class="title">Author</p><p class="name">omps</p><p class="content">Learning to blog, swim, cycle and run.</p></div></div><div class="disqus" id="comments"><div class="title"><h3><i class="fa fa-comments" aria-hidden="true"></i>&nbsp;Leave a comment on this post</h3></div><div class="content"><div id="disqus_thread"></div><script type="text/javascript"> var disqus_shortname = 'omps-in'; var disqus_identifier = '/blog/create-box-from-vagrant-virtualmachines/'; var disqus_title = 'Create box from vagrant virtualmachines'; var disqus_url = 'http://localhost:4000/blog/create-box-from-vagrant-virtualmachines/'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script></div></div></div></article></div></div></div><div class="footer"><div class="container-fluid"><div class="row-fluid"><div class="col-sm-4 copyright"> <span>omps.in © 2017-2018 • All right reserved.</span></div><div class="col-sm-4 message"> <span>theme based on Jekyll.</span></div><div class="col-sm-4 madeby"> <span>Made with&nbsp;<a href="https://jekyllrb.com" target="_blank">Jekyll</a>&nbsp;using&nbsp;<a href="https://github.com/williamcanin/typing-jekyll-template" target="_blank">Typing</a>&nbsp;Theme.</span></div><a class="pull-right top" href="#top"><i class="fa fa-caret-up" aria-hidden="true"></i></a></div></div></div></div><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> <script src="//netdna.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> <script src="http://localhost:4000/assets/javascripts/jekyll-spotify-plugin.min.js"></script> <script type="text/javascript"> jQuery(document).ready(function($) { $('.post > .row.content a').addClass('ga-event'); $('.page.spage > .row.content th a').addClass('ga-event'); $('.row.content li a').removeClass('ga-event'); $('a.ga-event').attr('onclick', 'ga(\'send\',\'event\',\'linkTo\',this.href,\'http://localhost:4000/blog/create-box-from-vagrant-virtualmachines/\');'); }); </script> <script src="http://localhost:4000/assets/javascripts/global.js"></script></body></html>
